{{% set chrony_service_name = chrony_service_name|default('chronyd') -%}}
documentation_complete: true

title: 'The {{{ chrony_service_name }}} service is enabled'

description: |-
    chrony is a daemon which implements the Network Time Protocol (NTP) is designed to
    synchronize system clocks across a variety of systems and use a source that is highly
    accurate. More information on chrony can be found at
    {{{ weblink(link="http://chrony.tuxfamily.org/") }}}.
    Chrony can be configured to be a client and/or a server.
    To enable {{{chrony_service_name}}} service, you can run:
    <tt># systemctl enable {{{ chrony_service_name }}}.service</tt>
    This recommendation only applies if chrony is in use on the system.

rationale: |-
    If chrony is in use on the system proper configuration is vital to ensuring time
    synchronization is working properly.

severity: medium

platform: machine

identifiers:
    cce@rhel7: CCE-83420-0
    cce@rhel8: CCE-82875-6
    cce@rhel9: CCE-84217-9

references:
    cis@rhel7: 2.2.1.3
    cis@rhel8: 2.2.1.2
    cis@ubuntu2004: 2.1.1.3
    ism: 0988,1405
    srg: SRG-OS-000355-GPOS-00143

ocil_clause: 'the {{{ chrony_service_name }}} process is not running'

ocil: |-
    {{{ ocil_service_enabled(service=chrony_service_name) }}}

fixtext: '{{{ fixtext_service_enabled(service=chrony_service_name) }}}'

srg_requirement: '{{{ srg_requirement_service_enabled(service=chrony_service_name) }}}'

template:
    name: service_enabled
    vars:
        servicename: '{{{ chrony_service_name }}}'
        packagename: chrony
