---
policy: 'CIS Benchmark for Ubuntu 20.04'
title: 'CIS Benchmark for Ubuntu 20.04'
id: cis_ubuntu2004
version: '1.1.0'
source: https://www.cisecurity.org/benchmark/ubuntu_linux
levels:
  - id: l1_server
  - id: l2_server
    inherits_from:
      - l1_server
  - id: l1_workstation
  - id: l2_workstation
    inherits_from:
      - l1_workstation

controls:
  - id: 1
    title: Initial Setup
    status: partial
    controls:
      - id: 1.1
        title: Filesystem Configuration
        status: partial
        controls:
          - id: 1.1.1
            title: Disable unused filesystems
            controls:
              - id: 1.1.1.1
                title: Ensure mounting of cramfs filesystems is disabled
                levels:
                  - l1_server
                  - l1_workstation
                status: automated
                rules:
                  - kernel_module_cramfs_disabled

              - id: 1.1.1.2
                title: Ensure mounting of freevxfs filesystems is disabled
                levels:
                  - l1_server
                  - l1_workstation
                status: automated
                rules:
                  - kernel_module_freevxfs_disabled

              - id: 1.1.1.3
                title: Ensure mounting of jffs2 filesystems is disabled
                levels:
                  - l1_server
                  - l1_workstation
                status: automated
                rules:
                  - kernel_module_jffs2_disabled

              - id: 1.1.1.4
                title: Ensure mounting of hfs filesystems is disabled
                levels:
                  - l1_server
                  - l1_workstation
                status: automated
                rules:
                  - kernel_module_hfs_disabled

              - id: 1.1.1.5
                title: Ensure mounting of hfsplus filesystems is disabled
                levels:
                  - l1_server
                  - l1_workstation
                status: automated
                rules:
                  - kernel_module_hfsplus_disabled

              - id: 1.1.1.6
                title: Ensure mounting of squashfs filesystems is disabled
                levels:
                  - l2_server
                  - l2_workstation
                status: automated
                rules:
                  - kernel_module_squashfs_disabled

              - id: 1.1.1.7
                title: Ensure mounting of udf filesystems is disabled
                levels:
                  - l1_server
                  - l1_workstation
                status: automated
                rules:
                  - kernel_module_udf_disabled

          - id: 1.1.2
            title: Ensure /tmp is configured
            levels:
              - l1_server
              - l1_workstation
            status: automated
            rules:
              - partition_for_tmp

          - id: 1.1.3
            title: Ensure nodev option set on /tmp partition
            levels:
              - l1_server
              - l1_workstation
            status: automated
            rules:
              - mount_option_tmp_nodev

          - id: 1.1.4
            title: Ensure nosuid option set on /tmp partition
            levels:
              - l1_server
              - l1_workstation
            status: automated
            rules:
              - mount_option_tmp_nosuid

          - id: 1.1.5
            title: Ensure noexec option set on /tmp partition
            levels:
              - l1_server
              - l1_workstation
            status: automated
            rules:
              - mount_option_tmp_noexec

          - id: 1.1.6
            title: Ensure /dev/shm is configured
            levels:
              - l1_server
              - l1_workstation
            status: supported

          - id: 1.1.7
            title: Ensure nodev option set on /dev/shm partition
            levels:
              - l1_server
              - l1_workstation
            status: automated
            rules:
              - mount_option_dev_shm_nodev

          - id: 1.1.8
            title: Ensure nosuid option set on /dev/shm partition
            levels:
              - l1_server
              - l1_workstation
            status: automated
            rules:
              - mount_option_dev_shm_nosuid

          - id: 1.1.9
            title: Ensure noexec option set on /dev/shm partition
            levels:
              - l1_server
              - l1_workstation
            status: automated
            rules:
              - mount_option_dev_shm_noexec

          - id: 1.1.10
            title: Ensure separate partition exists for /var
            levels:
              - l2_server
              - l2_workstation
            status: automated
            rules:
              - partition_for_var

          - id: 1.1.11
            title: Ensure separate partition exists for /var/tmp
            levels:
              - l2_server
              - l2_workstation
            status: automated
            rules:
              - partition_for_var_tmp

          - id: 1.1.12
            title: Ensure /var/tmp partition includes the nodev option
            levels:
              - l1_server
              - l1_workstation
            status: automated
            rules:
              - mount_option_var_tmp_nodev

          - id: 1.1.13
            title: Ensure /var/tmp partition includes the nosuid option
            levels:
              - l1_server
              - l1_workstation
            status: automated
            rules:
              - mount_option_var_tmp_nosuid

          - id: 1.1.14
            title: Ensure /var/tmp partition includes the noexec option
            levels:
              - l1_server
              - l1_workstation
            status: automated
            rules:
              - mount_option_var_tmp_noexec

          - id: 1.1.15
            title: Ensure separate partition exists for /var/log
            levels:
              - l2_server
              - l2_workstation
            status: automated
            rules:
              - partition_for_var_log

          - id: 1.1.16
            title: Ensure separate partition exists for /var/log/audit
            levels:
              - l2_server
              - l2_workstation
            status: automated
            rules:
              - partition_for_var_log_audit

          - id: 1.1.17
            title: Ensure separate partition exists for /home
            levels:
              - l2_server
              - l2_workstation
            status: automated
            rules:
              - partition_for_home

          - id: 1.1.18
            title: Ensure /home partition includes the nodev option
            levels:
              - l1_server
              - l1_workstation
            status: automated
            rules:
              - mount_option_home_nodev

          - id: 1.1.19
            title: Ensure nodev option set on removable media partitions
            levels:
              - l1_server
              - l1_workstation
            status: manual

          - id: 1.1.20
            title: Ensure nosuid option set on removable media partitions
            levels:
              - l1_server
              - l1_workstation
            status: manual

          - id: 1.1.21
            title: Ensure noexec option set on removable media partitions
            levels:
              - l1_server
              - l1_workstation
            status: manual

          - id: 1.1.22
            title: Ensure sticky bit is set on all world-writable directories
            levels:
              - l1_server
              - l1_workstation
            status: automated
            rules:
              - dir_perms_world_writable_sticky_bits

          - id: 1.1.23
            title: Disable Automounting
            levels:
              - l1_server
              - l2_workstation
            status: automated
            rules:
              - service_autofs_disabled

          - id: 1.1.24
            title: Disable USB Storage
            levels:
              - l1_server
              - l2_workstation
            status: automated
            rules:
              - kernel_module_usb-storage_disabled

      - id: 1.2
        title: Configure Software Updates
        status: partial
        controls:
          - id: 1.2.1
            title: Ensure package manager repositories are configured
            levels:
              - l1_server
              - l1_workstation
            status: manual

          - id: 1.2.2
            title: Ensure GPG keys are configured
            levels:
              - l1_server
              - l1_workstation
            status: manual

      - id: 1.3
        title: Filesystem Integrity Checking
        status: partial
        controls:
          - id: 1.3.1
            title: Ensure AIDE is installed
            levels:
              - l1_server
              - l1_workstation
            status: automated
            rules:
              - package_aide_installed
              - aide_build_database

          - id: 1.3.2
            title: Ensure filesystem integrity is regularly checked
            levels:
              - l1_server
              - l1_workstation
            status: automated
            rules:
              - aide_periodic_cron_checking

      - id: 1.4
        title: Secure Boot Settings
        status: partial
        controls:
          - id: 1.4.1
            title: Ensure permissions on bootloader config are not overridden
            levels:
              - l1_server
              - l1_workstation
            status: planned

          - id: 1.4.2
            title: Ensure bootloader password is set
            levels:
              - l1_server
              - l1_workstation
            status: automated
            rules:
              - grub2_password
              - grub2_uefi_password

          - id: 1.4.3
            title: Ensure permissions on bootloader config are configured
            levels:
              - l1_server
              - l1_workstation
            status: automated
            rules:
              - file_owner_grub2_cfg
              - file_groupowner_grub2_cfg
              - file_permissions_grub2_cfg
              - file_groupowner_efi_grub2_cfg
              - file_owner_efi_grub2_cfg
              - file_permissions_efi_grub2_cfg

          - id: 1.4.4
            title: Ensure authentication required for single user mode
            levels:
              - l1_server
              - l1_workstation
            status: planned

      - id: 1.5
        title: Additional Process Hardening
        status: partial
        controls:
          - id: 1.5.1
            title: Ensure XD/NX support is enabled
            levels:
              - l1_server
              - l1_workstation
            status: manual

          - id: 1.5.2
            title: Ensure address space layout randomization (ASLR) is enabled
            levels:
              - l1_server
              - l1_workstation
            status: automated
            rules:
              - sysctl_kernel_randomize_va_space

          - id: 1.5.3
            title: Ensure prelink is not installed
            levels:
              - l1_server
              - l1_workstation
            status: automated
            rules:
              - package_prelink_removed

          - id: 1.5.4
            title: Ensure core dumps are restricted
            levels:
              - l1_server
              - l1_workstation
            status: automated
            rules:
              - disable_users_coredumps
              - sysctl_fs_suid_dumpable
        
      - id: 1.6
        title: Mandatory Access Control
        status: partial
        controls:
          - id: 1.6.1
            title: Configure AppArmor
            status: partial
            controls:
              - id: 1.6.1.1
                title: Ensure AppArmor is installed
                levels:
                  - l1_server
                  - l1_workstation
                status: automated
                rules:
                  - package_apparmor_installed

              - id: 1.6.1.2
                title: Ensure AppArmor is enabled in the bootloader configuration
                levels:
                  - l1_server
                  - l1_workstation
                status: automated
                rules:
                  - grub2_enable_apparmor

              - id: 1.6.1.3
                title: Ensure all AppArmor Profiles are in enforce or complain mode
                levels:
                  - l1_server
                  - l1_workstation
                status: planned

              - id: 1.6.1.4
                title: Ensure all AppArmor Profiles are enforcing
                levels:
                  - l2_server
                  - l2_workstation
                status: planned

      - id: 1.7
        title: Command Line Warning Banners
        status: partial
        controls:
          - id: 1.7.1
            title: Ensure message of the day is configured properly
            levels:
              - l1_server
              - l1_workstation
            status: automated
            rules:
              - login_banner_text=cis_default
              - banner_etc_motd

          - id: 1.7.2
            title: Ensure local login warning banner is configured properly
            levels:
              - l1_server
              - l1_workstation
            status: automated
            rules:
              - login_banner_text=cis_default
              - banner_etc_issue

          - id: 1.7.3
            title: Ensure remote login warning banner is configured properly
            levels:
              - l1_server
              - l1_workstation
            status: automated
            rules:
              - login_banner_text=cis_default
              - banner_etc_issue_net

          - id: 1.7.4
            title: Ensure permissions on /etc/motd are configured
            levels:
              - l1_server
              - l1_workstation
            status: automated
            rules:
              - file_groupowner_etc_motd
              - file_owner_etc_motd
              - file_permissions_etc_motd

          - id: 1.7.5
            title: Ensure permissions on /etc/issue are configured
            levels:
              - l1_server
              - l1_workstation
            status: automated
            rules:
              - file_groupowner_etc_issue
              - file_owner_etc_issue
              - file_permissions_etc_issue

          - id: 1.7.6
            title: Ensure permissions on /etc/issue.net are configured
            levels:
              - l1_server
              - l1_workstation
            status: automated
            rules:
              - file_groupowner_etc_issue_net
              - file_owner_etc_issue_net
              - file_permissions_etc_issue_net

      - id: 1.8
        title: GNOME Display Manager
        status: partial
        controls:
          - id: 1.8.1
            title: Ensure GNOME Display Manager is removed
            levels:
              - l2_server
            status: automated
            rules:
              - package_gdm_removed
              - '!enable_dconf_user_profile'
              - '!dconf_gnome_banner_enabled'
              - '!dconf_gnome_login_banner_text'
              - '!dconf_gnome_disable_user_list'

          - id: 1.8.2
            title: Ensure GDM login banner is configured
            levels:
              - l1_server
              - l1_workstation
            status: automated
            rules:
              - dconf_gnome_banner_enabled
              - dconf_gnome_login_banner_text

          - id: 1.8.3
            title: Ensure disable-user-list is enabled
            levels:
              - l1_server
              - l1_workstation
            status: automated
            rules:
              - dconf_gnome_disable_user_list

          - id: 1.8.4
            title: Ensure XDCMP is not enabled
            levels:
              - l1_server
              - l1_workstation
            status: automated
            rules:
              - gnome_gdm_disable_xdmcp

      - id: 1.9
        title: Ensure updates, patches, and additional security software are installed
        levels:
          - l1_server
          - l1_workstation
        status: manual

  - id: 2
    title: Services
    status: partial
    controls:
      - id: 2.1
        title: Special Purpose Services
        status: partial
        controls:
          - id: 2.1.1
            title: Time Synchronization
            status: automated
            controls:
              - id: 2.1.1.1
                title: Ensure time synchronization is in use
                status: manual
              
              - id: 2.1.1.2
                title: Ensure systemd-timesyncd is configured
                status: automated
                rules:
                  - package_timesyncd_installed
                  - service_timesyncd_enabled

              - id: 2.1.1.3
                title: Ensure chrony is configured
                status: automated
                rules:
                  - package_chrony_installed
                  - service_chronyd_enabled
                  - chronyd_run_as_chrony_user
                  - chronyd_specify_remote_server

              - id: 2.1.1.4
                title: Ensure ntp is configured
                status: automated
                rules:
                  - package_ntp_installed
                  - service_ntp_enabled
                  - ntpd_configure_restrictions
                  - ntpd_run_as_ntp_user
                  - ntpd_specify_multiple_servers
                  - ntpd_specify_remote_server
            
          - id: 2.1.2
            title: Ensure X Window System is not installed
            status: automated
            rules:
              - package_xorg-x11-server-common_removed

          - id: 2.1.3
            title: Ensure Avahi Server is not installed
            status: automated
            rules:
              - service_avahi-daemon_disabled

          - id: 2.1.4
            title: Ensure CUPS is not installed
            status: automated
            rules:
              - service_cups_disabled
              - package_cups_removed

          - id: 2.1.5
            title: Ensure DHCP Server is not installed
            status: automated
            rules:
              - package_dhcp_removed

          - id: 2.1.6
            title: Ensure LDAP server is not installed
            status: automated
            rules:
              - package_openldap-servers_removed

          - id: 2.1.7
            title: Ensure NFS is not installed
            status: automated
            rules:
              - package_nfs-kernel-server_removed

          - id: 2.1.8
            title: Ensure DNS Server is not installed
            status: automated
            rules:
              - package_bind_removed

          - id: 2.1.9
            title: Ensure FTP Server is not installed
            status: automated
            rules:
              - package_vsftpd_removed

          - id: 2.1.10
            title: Ensure HTTP server is not installed
            status: automated
            rules:
              - package_httpd_removed

          - id: 2.1.11
            title: Ensure IMAP and POP3 server are not installed
            status: automated
            rules:
              - package_dovecot_removed

          - id: 2.1.12
            title: Ensure Samba is not installed
            status: automated
            rules:
              - package_samba_removed

          - id: 2.1.13
            title: Ensure HTTP Proxy Server is not installed
            status: automated
            rules:
              - package_squid_removed

          - id: 2.1.14
            title: Ensure SNMP Server is not installed
            status: planned

          - id: 2.1.15
            title: Ensure mail transfer agent is configured for local-only mode
            status: planned

          - id: 2.1.16
            title: Ensure rsync service is not installed
            status: planned

          - id: 2.1.17
            title: Ensure NIS Server is not installed
            status: planned

      - id: 2.2
        title: Service clients
        status: partial
          - id: 2.2.1
            title: 
            status: planned

          - id: 2.2.2
            title: 
            status: planned

          - id: 2.2.3
            title: 
            status: planned

          - id: 2.2.4
            title: 
            status: planned

          - id: 2.2.5
            title: 
            status: planned

          - id: 2.2.6
            title: 
            status: planned

      - id: 2.3
        title: Ensure nonessential services are removed or masked
        status: manual

  - id: 3
    title: Network Configuration
    status: partial
    controls:
      - id: 3.1
        title: Disable unused network protocols and devices
        status: partial
        controls:
          - id: 3.1.1
            title: Disable IPv6
            status: planned

          - id: 3.1.2
            title: Ensure wireless interfaces are disabled
            status: planned

      - id: 3.2
        title: Network Parameters (Host Only)
        status: partial
        controls:
          - id: 3.2.1
            title: Ensure packet redirect sending is disabled
            status: planned

          - id: 3.2.2
            title: Ensure IP forwarding is disabled
            status: planned

      - id: 3.3
        title: Network Parameters (Host and Router)
        status: partial
        controls:
          - id: 3.3.1
            title: Ensure source routed packets are not accepted
            status: planned

          - id: 3.3.2
            title: Ensure ICMP redirects are not accepted
            status: planned

          - id: 3.3.3
            title: Ensure secure ICMP redirects are not accepted
            status: planned

          - id: 3.3.4
            title: Ensure suspicious packets are logged
            status: planned

          - id: 3.3.5
            title: Ensure broadcast ICMP requests are ignored
            status: planned

          - id: 3.3.6
            title: Ensure bogus ICMP responses are ignored
            status: planned

          - id: 3.3.7
            title: Ensure Reverse Path Filtering is enabled
            status: planned

          - id: 3.3.8
            title: Ensure TCP SYN Cookies is enabled
            status: planned

          - id: 3.3.9
            title: Ensure IPv6 router advertisements are not accepted
            status: planned

      - id: 3.4
        title: Uncommon Network Protocols
        status: partial
        controls:
          - id: 3.4.1
            title: Ensure DCCP is disabled
            status: planned

          - id: 3.4.2
            title: Ensure SCTP is disabled
            status: planned

          - id: 3.4.3
            title: Ensure RDS is disabled
            status: planned

          - id: 3.4.4
            title: Ensure TIPC is disabled
            status: planned

      - id: 3.5
        title: Firewall Configuration
        status: partial
        controls:
          - id: 3.5.1
            title: Configure UncomplicatedFirewall
            status: planned

          - id: 3.5.2
            title: Configure nftables
            status: planned

          - id: 3.5.3
            title: Configure iptables
            status: planned

  - id: 4
    title: Logging and Auditing
    status: partial
    controls:
      - id: 4.1
        title: Configure System Accounting (auditd)
        status: partial
        controls:
          - id: 4.1.1
            title: 
            status: planned

          - id: 4.1.2
            title: 
            status: planned

          - id: 4.1.3
            title: 
            status: planned

          - id: 4.1.4
            title: 
            status: planned

          - id: 4.1.5
            title: 
            status: planned

          - id: 4.1.6
            title: 
            status: planned

          - id: 4.1.7
            title: 
            status: planned

          - id: 4.1.8
            title: 
            status: planned

          - id: 4.1.9
            title: 
            status: planned

          - id: 4.1.10
            title: 
            status: planned

          - id: 4.1.11
            title: 
            status: planned

          - id: 4.1.12
            title: 
            status: planned

          - id: 4.1.13
            title: 
            status: planned

          - id: 4.1.14
            title: 
            status: planned

          - id: 4.1.15
            title: 
            status: planned

          - id: 4.1.16
            title: 
            status: planned

          - id: 4.1.17
            title: 
            status: planned

      - id: 4.2
        title: 
        status: planned

      - id: 4.3
        title: 
        status: planned

      - id: 4.4
        title: 
        status: planned

  - id: 5
    title: Access, Authentication and Authorization
    status: partial
    controls:
      - id: 5.1
        title: 
        status: planned

      - id: 5.2
        title: 
        status: planned

      - id: 5.3
        title: 
        status: planned

      - id: 5.4
        title: 
        status: planned

      - id: 5.5
        title: 
        status: planned

      - id: 5.6
        title: 
        status: planned

      - id: 5.7
        title: 
        status: planned

  - id: 6
    title: System Maintenance
    status: partial
    controls:
      - id: 6.1
        title: 
        status: planned

      - id: 6.2
        title: 
        status: planned